(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["apiShop/goods/main"],{"010c":function(t,e,n){"use strict";var a=n("7b36"),o=n.n(a);o.a},"1f17":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"2b60":function(t,e,n){"use strict";(function(t){n("a2bf");a(n("66fd"));var e=a(n("761e"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"362d":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,o=u(n("a34a")),i=u(n("d796")),r=n("de50"),s=n("26b0");function u(t){return t&&t.__esModule?t:{default:t}}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=l(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw i}}}}function l(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function p(t,e,n,a,o,i,r){try{var s=t[i](r),u=s.value}catch(d){return void n(d)}s.done?e(u):Promise.resolve(u).then(a,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var i=t.apply(e,n);function r(t){p(i,a,o,r,s,"next",t)}function s(t){p(i,a,o,r,s,"throw",t)}r(void 0)}))}}var g=function(){n.e("components/linnian-CountDown/uni-countdown").then(function(){return resolve(n("3c76"))}.bind(null,n)).catch(n.oe)},m=(a={onLoad:function(){this.platform="微信小程序"},onShow:function(){}},d(a,"onLoad",(function(t){this.parent_id=t.parent_id,this.id=t.id,this.ral=t.ral,this.order_id=t.order_id})),d(a,"components",{uniCountdown:g}),d(a,"mounted",(function(){this.parent_id&&t.setStorageSync("parent_id",this.parent_id),this.id=this.id,this.ral=this.ral,this.order_id=this.order_id,null==this.order_id&&(this.order_id="0"),"true"==this.ral&&this.exchange_integral(),this.goodsDetail(),this.getDiscount(),t.removeStorageSync("pt_goods_id"),t.removeStorageSync("pt_product_id"),t.removeStorageSync("pt_num"),t.removeStorageSync("pt_order_id")})),d(a,"onShareAppMessage",(function(){return{title:info.goods_name,path:"/apiShop/goods/main?id="+this.id,imageUrl:this.gallery[0]}})),d(a,"data",(function(){return{share_img:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/images/share.png",qq:875358601,kefu_tel:"18888888888",modalName:null,allnumber:0,collectFlag:!1,number:1,showpop:!1,gallery:[],info:{},brand:{},attribute:[],issueList:[],productLookList:[],skuMap:{},ral:"",goods_desc:"",id:"",goodsId:"",integral:"",productId:"",allPrise:"",goodsInergral:"",defaultSkuStore:"",goodsSkuNameList:"",goodsSkuList:"",allSkuVal:[],activeSkuValId:{},goods_type:"",pintuan:"0",pt_list:[],order_id:"",avator:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/images/missing-face.png",hitCounts:"",platform:"",prompt:"",active:"",end_day:0,end_hour:0,end_minute:0,end_second:0,end_haomiao:0,result_value:"",pt_num:0,kefu_qq:"",file_list:[]}})),d(a,"methods",{goTomorepintuan:function(e){t.navigateTo({url:"/apiShop/pintuan/main?id="+e})},setCacheGoodsList:function(e,n,a,o){var i=t.getStorageSync("historyGoods");i?i.forEach((function(t,n){t.id===e&&i.splice(n,1)})):i=[];var r={id:e,img:n,goods_name:a,shop_price:o};i.unshift(r),i=i.slice(0,10),t.setStorageSync("historyGoods",i)},openQQ:function(){},togoodsDetail:function(e){t.redirectTo({url:"/apiShop/goods/main?id="+e})},showModal:function(t){this.modalName=t.currentTarget.dataset.target},hideModal:function(t){this.modalName=null},go:function(){t.makePhoneCall({phoneNumber:this.kefu_tel,success:function(t){console.log("调用成功!")},fail:function(t){console.log("调用失败!")}})},getDiscount:function(){var t=this;return h(o.default.mark((function e(){var n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,r.GoodsDiscountApi)({goods_id:t.id});case 2:n=e.sent,t.prompt=n.data.discount;case 4:case"end":return e.stop()}}),e)})))()},add:function(){this.number=parseInt(this.number)+1,this.defaultSkuStore<this.number&&(this.number=this.defaultSkuStore,t.showToast({title:"库存不足",icon:"none",duration:1500}))},reduce:function(){if(!(this.number>1))return!1;this.number=parseInt(this.number)-1},tagVal:function(t,e,n){var a=this;this.goodsSkuNameList.forEach((function(n,o){o===t&&(a.goodsSkuNameList[o].activeSkuVal=e),a.allSkuVal[o]=a.goodsSkuNameList[o].skuValList[a.goodsSkuNameList[o].activeSkuVal].skuValId})),this.activeSkuValId[t]=n,this.goodsSkuList.forEach((function(t,e){a.goodsSkuList[e].is_default=!1;var n=a.goodsSkuList[e].skuValIds.replace("[","").replace("]",""),o=a.allSkuVal.toString();o=o.split(","),o=o.sort().toString(),n=n.split(","),n=n.sort().toString(),n===o&&(a.goodsSkuList[e].is_default=!0,a.defaultSkuStore=a.goodsSkuList[e].stockNum,a.info.shop_price=a.goodsSkuList[e].price,a.productId=a.goodsSkuList[e].product_id)}))},upstarbuy:function(){return h(o.default.mark((function t(){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},integral_no:function(){var e=this;return h(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.goodsDetailActionApi)({goods_id:e.id});case 2:a=n.sent,"0"==a.data.info.time.default&&t.showToast({title:"商品秒杀未开始，不能购买哟~~",icon:"none",duration:2e3});case 4:case"end":return n.stop()}}),n)})))()},integral_spike:function(){var e=this;return h(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.getGoodSpikeApi)({goods_id:e.id});case 2:if(a=n.sent,null!=a.data){n.next=9;break}return n.next=6,(0,r.getPayPointsApi)({goods_id:e.id,num:e.number});case 6:n.sent,t.setStorageSync("integralGoodsid",e.id),t.navigateTo({url:"/apiCart/order/main?spike=true&goods_id="+e.id});case 9:if("fail"!=a.data.status){n.next=12;break}return t.showToast({title:"库存不足",icon:"none",duration:2e3}),n.abrupt("return",!1);case 12:case"end":return n.stop()}}),n)})))()},integral_exchange:function(){var e=this;return h(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.getPayPointsApi)({goods_id:e.id,num:e.number});case 2:a=n.sent,0==a.data.info?t.showToast({title:"积分不足，不能兑换",icon:"none",duration:2e3}):(t.setStorageSync("integralGoodsid",e.id),t.setStorageSync("jifennum",e.number),t.navigateTo({url:"/apiCart/order/main?ral=true"}));case 4:case"end":return n.stop()}}),n)})))()},fastbuy:function(){var e=this;return h(o.default.mark((function n(){var a,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(0,s.toLogin)()){n.next=24;break}if(!e.showpop){n.next=23;break}n.t0=o.default.keys(e.goodsSkuNameList);case 3:if((n.t1=n.t0()).done){n.next=10;break}if(a=n.t1.value,""!==e.goodsSkuNameList[a].activeSkuVal){n.next=8;break}return t.showToast({title:"请选择"+e.goodsSkuNameList[a].skuName,duration:2e3,icon:"none",mask:!0,success:function(t){}}),n.abrupt("return",!1);case 8:n.next=3;break;case 10:return 0==e.number&&t.showToast({title:"请选择商品数量",duration:2e3,icon:"none",mask:!0,success:function(t){}}),t.setStorageSync("productId",e.goodsId),Object.values(e.activeSkuValId).join(","),n.next=15,(0,r.goodsAddCartFastApi)({fastbuy:"true",goods_id:e.goodsId,sku:Object.values(e.activeSkuValId).join(","),num:e.number,product_id:e.productId});case 15:if(i=n.sent,console.info(i.data.add_cart),!1!==i.data.add_cart){n.next=20;break}return t.showToast({icon:"none",title:i.data.msg}),n.abrupt("return",!1);case 20:i.data.add_cart&&t.navigateTo({url:"/apiCart/order/main"}),n.next=24;break;case 23:e.showpop=!0;case 24:case"end":return n.stop()}}),n)})))()},collect:function(){var t=this;return h(o.default.mark((function e(){var n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(0,s.toLogin)()){e.next=6;break}return e.next=3,(0,r.goodsAddCollectApi)({goods_id:t.goodsId,collect_status:t.collectFlag});case 3:n=e.sent,t.collectFlag=n.data.res,console.log("当前的收藏状态"+t.collectFlag);case 6:case"end":return e.stop()}}),e)})))()},addCart:function(){var e=this;return h(o.default.mark((function n(){var a,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(0,s.toLogin)()){n.next=26;break}if(!e.showpop){n.next=25;break}n.t0=o.default.keys(e.goodsSkuNameList);case 3:if((n.t1=n.t0()).done){n.next=10;break}if(a=n.t1.value,""!==e.goodsSkuNameList[a].activeSkuVal){n.next=8;break}return t.showToast({title:"请选择"+e.goodsSkuNameList[a].skuName,duration:2e3,icon:"none",mask:!0,success:function(t){}}),n.abrupt("return",!1);case 8:n.next=3;break;case 10:if(0!=e.number){n.next=13;break}return t.showToast({title:"请选择商品数量",duration:2e3,icon:"none",mask:!0,success:function(t){}}),n.abrupt("return",!1);case 13:return Object.values(e.activeSkuValId).join(","),n.next=16,(0,r.goodsAddCartApi)({goods_id:e.goodsId,sku:Object.values(e.activeSkuValId).join(","),num:e.number,product_id:e.productId});case 16:if(i=n.sent,!1!==i.data.add_cart){n.next=20;break}return t.showToast({icon:"none",title:i.data.msg}),n.abrupt("return",!1);case 20:console.log(e.defaultSkuStore),console.log(e.number),e.defaultSkuStore<e.number?t.showToast({title:"库存不足",icon:"none",duration:1500}):(e.allnumber=parseInt(e.allnumber)+parseInt(e.number),e.allnumber>99&&(e.allnumber="99+"),t.showToast({title:"添加购物车成功",icon:"success",duration:1500})),n.next=26;break;case 25:e.showpop=!0;case 26:case"end":return n.stop()}}),n)})))()},toCart:function(){t.switchTab({url:"/pages/cart/main"})},goodsDetail:function(){var t=this;return h(o.default.mark((function e(){var n,a,i,s,u,d;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,r.goodsDetailActionApi)({goods_id:t.id,platform:t.platform});case 2:if(n=e.sent,t.file_list=n.data.file_list,t.hitCounts=n.data.hitCounts,t.gallery=n.data.gallery,t.info=n.data.info,t.allPrise=n.data.info.shop_price,t.integral=n.data.info.rank_integral,t.goodsId=t.info.goods_id,t.productId=n.data.info.productId,t.brand=n.data.brand,t.url_fenxiang=n.data.url_fenxiang,n.data.kefu_tel&&(t.kefu_tel=n.data.kefu_tel.val),n.data.kefu_qq&&(t.kefu_qq=n.data.kefu_qq),t.attribute=n.data.attrlist,t.active=n.data.info.active,console.log(t.url_fenxiang),t.activeSkuValId=n.data.activeSkuValId,t.miaosha=t.info.active,"true"==t.miaosha&&(t.result_value=n.data.info.time.default,t.end_day=n.data.info.time.day,t.end_hour=n.data.info.time.hour,t.end_minute=n.data.info.time.minute,t.end_second=n.data.info.time.second),t.goods_desc=n.data.info.goods_desc.replace(/\<img/gi,'<img style="max-width:100%;height:auto;vertical-align: bottom;" '),t.issueList=n.data.issue,t.collectFlag=n.data.collected,t.allnumber=n.data.allnumber,t.allnumber>"99"&&(t.allnumber="99+"),t.productLookList=n.data.productLookList,""==n.data.defaultSkuData||!n.data.defaultSkuData){e.next=53;break}t.defaultSkuStore=n.data.defaultSkuData.stock,t.info.shop_price=n.data.defaultSkuData.price,a=n.data.goodsSkuList,t.productId=n.data.defaultSkuData.product_id,i=c(a),e.prev=33,i.s();case 35:if((s=i.n()).done){e.next=43;break}if(u=s.value,u.product_id!=t.productId){e.next=41;break}return d=u.skuValIds.replace("[","").replace("]","").split(","),t.activeSkuValId=d,e.abrupt("break",43);case 41:e.next=35;break;case 43:e.next=48;break;case 45:e.prev=45,e.t0=e["catch"](33),i.e(e.t0);case 48:return e.prev=48,i.f(),e.finish(48);case 51:e.next=54;break;case 53:t.defaultSkuStore=n.data.defaultSkuStore;case 54:t.goodsSkuNameList=n.data.goodsSkuNameList,t.goodsSkuList=n.data.goodsSkuList,t.setCacheGoodsList(t.id,t.info.goods_thumb,t.info.goods_name,t.info.shop_price),t.pintuan=n.data.active.pintuan.is_pintuan,"1"==t.pintuan&&(t.goods_type="pintuan",t.pt_info=n.data.pt_info,t.pt_list=t.pt_info.pt_list,t.pt_num=t.pt_info.pt_num.num);case 59:case"end":return e.stop()}}),e,null,[[33,45,48,51]])})))()},exchange_integral:function(){var t=this;return h(o.default.mark((function e(){var n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getGoodsintegral)({goods_id:t.id});case 2:n=e.sent,t.goodsInergral=n.data.exchange_integral;case 4:case"end":return e.stop()}}),e)})))()},click_pintuan:function(){var e=this;return h(o.default.mark((function n(){var a,i,s;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.showpop){n.next=31;break}n.t0=o.default.keys(e.goodsSkuNameList);case 2:if((n.t1=n.t0()).done){n.next=9;break}if(a=n.t1.value,""!==e.goodsSkuNameList[a].activeSkuVal){n.next=7;break}return t.showToast({title:"请选择"+e.goodsSkuNameList[a].skuName,duration:2e3,icon:"none",mask:!0,success:function(t){}}),n.abrupt("return",!1);case 7:n.next=2;break;case 9:if("0"!=e.order_id){n.next=18;break}return n.next=12,(0,r.getGoodsPintuanApi)({goods_id:e.id,order_id:"0"});case 12:if(i=n.sent,"fail"!=i.data.status){n.next=16;break}return t.showToast({icon:"none",title:"非拼团商品"}),n.abrupt("return",!1);case 16:n.next=25;break;case 18:return n.next=20,(0,r.getGoodsPintuanApi)({goods_id:e.id,order_id:e.order_id});case 20:if(s=n.sent,"fail"!=s.data.status){n.next=24;break}return t.showToast({icon:"none",title:"拼单商品错误"}),n.abrupt("return",!1);case 24:t.setStorageSync("pt_order_id",e.order_id);case 25:t.setStorageSync("pt_goods_id",e.id),t.setStorageSync("pt_product_id",e.productId),t.setStorageSync("pt_num",e.number),t.navigateTo({url:"/apiCart/order/main?pintuan=true"}),n.next=32;break;case 31:e.showpop=!0;case 32:case"end":return n.stop()}}),n)})))()},pindan:function(e){if(this.order_id=e,this.showpop){for(var n in this.goodsSkuNameList)if(""===this.goodsSkuNameList[n].activeSkuVal)return t.showToast({title:"请选择"+this.goodsSkuNameList[n].skuName,duration:2e3,icon:"none",mask:!0,success:function(t){}}),!1}else this.showpop=!0},showType:function(){this.showpop=!this.showpop},gotojudge:function(e){t.navigateTo({url:"/apiShop/userjudge/main?id="+e})},shareInfo:function(){var e=this,n={href:this.url_fenxiang,title:this.info.goods_name,desc:this.info.goods_name,imgUrl:this.info.goods_thumb},a=[{icon:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/sharemenu/wx.png",text:"微信好友"},{icon:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/sharemenu/pyq.png",text:"朋友圈"},{icon:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/sharemenu/qq.png",text:"QQ"},{icon:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/sharemenu/copy.png",text:"复制"},{icon:"https://imgt1.oss-cn-shanghai.aliyuncs.com/ecAllRes/sharemenu/more.png",text:"更多"}];this.shareObj=(0,i.default)(n,a,(function(e){console.log("点击按钮的序号: "+e);var a={href:n.href||"",title:n.title||"",summary:n.desc||"",success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}};switch(e){case 0:a.provider="weixin",a.scene="WXSceneSession",a.type=0,a.imageUrl=n.imgUrl||"",t.share(a);break;case 1:a.provider="weixin",a.scene="WXSenceTimeline",a.type=0,a.imageUrl=n.imgUrl||"",t.share(a);break;case 2:a.provider="qq",a.type=1,a.imageUrl=n.imgUrl||"",t.share(a);break;case 3:t.setClipboardData({data:n.href,complete:function(){t.showToast({title:"已复制到剪贴板"})}});break;case 5:plus.share.sendWithSystem({type:"web",title:n.title||"",thumbs:[n.imgUrl||""],href:n.href||"",content:n.desc||""});break}})),this.$nextTick((function(){e.shareObj.alphaBg.show(),e.shareObj.shareMenu.show()}))}}),d(a,"computed",{}),a);e.default=m}).call(this,n("543d")["default"])},"761e":function(t,e,n){"use strict";n.r(e);var a=n("1f17"),o=n("e479");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("010c");var r,s=n("f0c5"),u=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"06f15ffb",null,!1,a["a"],r);e["default"]=u.exports},"7b36":function(t,e,n){},e479:function(t,e,n){"use strict";n.r(e);var a=n("362d"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a}},[["2b60","common/runtime","common/vendor"]]]);