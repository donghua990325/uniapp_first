(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["apiPam/login/main"],{"01ec":function(e,n,t){"use strict";var o=t("27c0"),a=t.n(o);a.a},2732:function(e,n,t){"use strict";var o;t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o}));var a=function(){var e=this,n=e.$createElement;e._self._c},r=[]},2739:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(t("a34a")),a=t("de50"),r=t("26b0");function i(e){return e&&e.__esModule?e:{default:e}}function c(e,n,t,o,a,r,i){try{var c=e[r](i),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(o,a)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(o,a){var r=e.apply(n,t);function i(e){c(r,o,a,i,u,"next",e)}function u(e){c(r,o,a,i,u,"throw",e)}i(void 0)}))}}var s={onShow:function(){this.userInfo=(0,r.getStorageUserInfo)()},created:function(){},onLoad:function(e){this.parent_id=e.parent_id,this.logo()},mounted:function(){this.parent_id&&(this.parent_id=this.parent_id,e.setStorageSync("parent_id",this.parent_id),console.log(e.getStorageSync("parent_id")))},data:function(){return{openId:"",userInfo:[],code:"",accesstoken:"",user_id:"",logoImage:"",unionid:"",parent_id:""}},components:{},methods:{logo:function(){var e=this;return u(o.default.mark((function n(){var t;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,a.loginLogo)({});case 2:t=n.sent,e.logoImage=t.data.logo_other;case 4:case"end":return n.stop()}}),n)})))()},phoneLogin:function(){e.navigateTo({url:"/apiPam/logincommon/main"})},onGetAuthorize:function(n){var t=this;return u(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.getOpenUserInfo({fail:function(e){},success:function(n){var i=JSON.parse(n.response).response;console.log(i),t.userInfo=i,t.userInfo.language="zh_CN",t.userInfo.country=i.countryCode,t.userInfo.avatarUrl=i.avatar,e.setStorageSync("userInfo",t.userInfo),e.showLoading({title:"登录中...",success:function(e){}}),e.getAuthCode({scopes:"auth_user",success:function(){var n=u(o.default.mark((function n(i){var c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!i.authCode){n.next=5;break}return n.next=3,(0,a.loginAlipayApi)({code:i.authCode,nickname:t.userInfo.nickName,gender:t.userInfo.gender,avatarUrl:t.userInfo.avatarUrl,tagtype:"alipay"});case 3:c=n.sent,c.accesstoken?((0,r.quit)(),t.accesstoken=c.accesstoken,t.openId=c.openId,t.user_id=c.user_id,e.setStorageSync("userInfo",t.userInfo),e.setStorageSync("accesstoken",t.accesstoken),e.setStorageSync("user_id",t.user_id),e.setStorageSync("openId",t.openId),e.setStorageSync("tagtype","alipay"),e.hideLoading(),e.switchTab({url:"/pages/my/main"})):(t.openId=c.openId,e.setStorageSync("openId",t.openId),e.hideLoading(),e.navigateTo({url:"/apiPam/binding/main"}));case 5:case"end":return n.stop()}}),n)})));function i(e){return n.apply(this,arguments)}return i}()})}});case 1:case"end":return n.stop()}}),n)})))()},doLogin:function(){var n=this;return u(o.default.mark((function t(){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.showLoading({title:"登录中...",mask:!0,success:function(e){}}),e.login({success:function(t){t.code?(n.code=t.code,console.log("code的值为："+n.code),e.getUserInfo().then(function(){var t=u(o.default.mark((function t(i){var c,u;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(i),c=i[1].userInfo,e.setStorageSync("userInfo",c),n.userInfo=c,t.next=6,(0,a.loginWechatApi)({code:n.code,nickname:n.userInfo.nickName,gender:n.userInfo.gender,avatarUrl:n.userInfo.avatarUrl,tagtype:"weixin",platform:"MP-WEIXIN"});case 6:u=t.sent,u.data.sess_id?((0,r.quit)(),n.accesstoken=u.data.sess_id,n.openId=u.data.openid,n.user_id=u.data.user_id,n.unionid=u.data.unionid,e.setStorageSync("userInfo",n.userInfo),e.setStorageSync("accesstoken",n.accesstoken),e.setStorageSync("user_id",n.user_id),e.setStorageSync("openId",n.openId),e.setStorageSync("unionid",n.unionid),e.setStorageSync("tagtype","weixin"),e.hideLoading(),e.switchTab({url:"/pages/my/main"})):(n.openId=u.data.openid,n.unionid=u.data.unionid,e.setStorageSync("openId",n.openId),e.setStorageSync("unionid",n.unionid),e.hideLoading(),e.navigateTo({url:"/apiPam/binding/main"}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)})).finally((function(){e.hideLoading()}))):console.log("登录失败！"+t.errMsg)},fail:function(){},complete:function(){}});case 2:case"end":return t.stop()}}),t)})))()}},computed:{}};n.default=s}).call(this,t("543d")["default"])},"27c0":function(e,n,t){},"58e8":function(e,n,t){"use strict";t.r(n);var o=t("2732"),a=t("62a3");for(var r in a)"default"!==r&&function(e){t.d(n,e,(function(){return a[e]}))}(r);t("01ec");var i,c=t("f0c5"),u=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,"9f532350",null,!1,o["a"],i);n["default"]=u.exports},"62a3":function(e,n,t){"use strict";t.r(n);var o=t("2739"),a=t.n(o);for(var r in o)"default"!==r&&function(e){t.d(n,e,(function(){return o[e]}))}(r);n["default"]=a.a},"9f5c":function(e,n,t){"use strict";(function(e){t("a2bf");o(t("66fd"));var n=o(t("58e8"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])}},[["9f5c","common/runtime","common/vendor"]]]);