(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/main"],{"0313":function(t,e,a){"use strict";a.r(e);var n=a("0696"),s=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=s.a},"0696":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("a34a")),s=a("de50"),i=a("26b0");function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,a,n,s,i,r){try{var o=t[i](r),c=o.value}catch(u){return void a(u)}o.done?e(c):Promise.resolve(c).then(n,s)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(n,s){var i=t.apply(e,a);function r(t){o(i,n,s,r,c,"next",t)}function c(t){o(i,n,s,r,c,"throw",t)}r(void 0)}))}}var u={onShow:function(){(0,i.getStorageUserInfo)()&&this.getListData(),this.getCacheGoodsList()},created:function(){},data:function(){return{allPrise:"",allcheck:!1,listData:[],Listids:[],tranX:0,tranX1:0,startX:"",startY:"",moveX:"",moveY:"",moveEndX:"",moveEndY:"",X:0,Y:"",historyGoods:[]}},components:{},methods:{changeCartNumber:function(e,a,i,r){var o=this;return c(n.default.mark((function r(){var c,u,l,d;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c=/^\d+$/,!(a<=0)){n.next=5;break}return u=o,t.showToast({icon:"none",duration:1e3,title:"数量不能小于等于0",success:function(){setTimeout((function(){u.getListData()}),1e3)}}),n.abrupt("return",!1);case 5:if(!1!==c.test(a)){n.next=9;break}return t.showToast({icon:"none",duration:1e3,title:"数量输入有误"}),o.getListData(),n.abrupt("return",!1);case 9:return n.next=11,(0,s.cartUpdateNumApi)({number:a,goods_id:e,product_id:i});case 11:if(l=n.sent,d=o,!1!==l.data.update_cart){n.next=17;break}return t.showToast({icon:"none",title:l.data.msg,success:function(t){setTimeout((function(){d.getListData()}),1e3)}}),console.log(22222),n.abrupt("return",!1);case 17:o.getListData(),o.allPrise=l.data.totalPrice;case 19:case"end":return n.stop()}}),r)})))()},countGoodsNumber:function(e,a){var i=this;return c(n.default.mark((function r(){var o,c;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!a){n.next=4;break}e.goods_number++,n.next=9;break;case 4:if(!(e.goods_number<=1)){n.next=8;break}return mpvue.showToast({title:"本商品1件起售",icon:"none",duration:1500}),e.goods_number=1,n.abrupt("return");case 8:e.goods_number--;case 9:return n.next=11,(0,s.cartUpdateNumApi)({number:e.goods_number,goods_id:e.goods_id,product_id:e.product_id});case 11:if(o=n.sent,!1!==o.data.update_cart){n.next=16;break}return c=i,t.showToast({icon:"none",title:o.data.msg,success:function(t){setTimeout((function(){console.log(e.goods_number),c.getListData()}),1e3)}}),n.abrupt("return",!1);case 16:i.getListData(),i.allPrise=o.data.totalPrice;case 18:case"end":return n.stop()}}),r)})))()},getCacheGoodsList:function(){var e=this;return c(n.default.mark((function a(){var i,r,o;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=t.getStorageSync("historyGoods"),!(i.length>=10)){a.next=5;break}e.historyGoods=i,a.next=11;break;case 5:return r=10,i.length&&(r=10-i.length),a.next=9,(0,s.recommendGoodsApi)({num:r});case 9:o=a.sent,e.historyGoods=i?i.concat(o.data):o.data;case 11:case"end":return a.stop()}}),a)})))()},initTextStyle:function(){for(var t=0;t<this.listData.length;t++)this.listData[t].textStyle="",this.listData[t].textStyle1=""},startMove:function(t){this.initTextStyle(),this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY},deleteGoods:function(t){this.initTextStyle();var e=t.currentTarget.dataset.index;this.X<=-100&&(this.flag=!0),this.flag?(this.moveX=t.touches[0].pageX,this.moveY=t.touches[0].pageY,this.X=this.moveX-this.startX,this.Y=this.moveX-this.startY,this.tranX=this.X-100,this.listData[e].textStyle="transform:translateX(".concat(this.tranX,"rpx);"),console.log(this.listData[e].textStyle),this.X+-100>-100&&(this.flag=!1),this.tranX1=-100,this.listData[e].textStyle1="transform:translateX(-100rpx);",console.log(this.listData[e].textStyle1)):(this.moveX=t.touches[0].pageX,this.moveY=t.touches[0].pageY,this.X=this.moveX-this.startX,this.Y=this.moveX-this.startY,this.listData[e].textStyle="transform:translateX(".concat(this.tranX,"rpx);"),this.X>=100&&(this.X=0),this.tranX=this.X,this.X<=-100&&(this.X=-100),this.tranX1=this.X,this.listData[e].textStyle1="transform:translateX(".concat(this.tranX1,"rpx);"))},endMove:function(t){var e=t.currentTarget.dataset.index;this.X>-50?(this.tranX1=0,this.tranX=0,this.listData[e].textStyle="transform:translateX(".concat(this.tranX,"rpx);"),this.listData[e].textStyle1="transform:translateX(".concat(this.tranX1,"rpx);")):this.X<=-50&&(this.tranX1=-100,this.tranX=-100,this.listData[e].textStyle="transform:translateX(".concat(this.tranX,"rpx);"),this.listData[e].textStyle1="transform:translateX(".concat(this.tranX1,"rpx);"))},orderDown:function(){var e=this;return c(n.default.mark((function a(){var s,i,r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!=e.allPrise){a.next=3;break}return t.showToast({title:"请选择商品",icon:"none",duration:1500}),a.abrupt("return",!1);case 3:for(s=[],i=0;i<e.Listids.length;i++)r=e.Listids[i],r&&s.push(r);t.navigateTo({url:"/apiCart/order/main"});case 6:case"end":return a.stop()}}),a)})))()},delGoods:function(e,a){var i=this;t.showModal({title:"",content:"是否要删除该商品",success:function(){var t=c(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.confirm){t.next=8;break}return i.Listids.splice(a,1),t.next=4,(0,s.cartDelApi)({id:e});case 4:t.sent,i.getListData(),t.next=9;break;case 8:r.cancel&&(console.log("用户点击取消"),this.initTextStyle());case 9:case"end":return t.stop()}}),t,this)})));function r(e){return t.apply(this,arguments)}return r}()})},getListData:function(){var t=this;return c(n.default.mark((function e(){var a,i,r;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,s.cartListApi)({});case 2:if(a=e.sent,!1!==a.data.info){e.next=8;break}return t.listData=[],t.allPrise=0,t.Listids=[],e.abrupt("return",!1);case 8:for(i=0;i<a.data.info.goods_list.length;i++)a.data.info.goods_list[i].textStyle="",a.data.info.goods_list[i].textStyle1="";if(a.data.hasOwnProperty("info"))for(r in t.listData=a.data.info.goods_list,t.listData)"true"===t.listData[r].is_checked?t.Listids[r]=t.listData[r].goods_id:t.Listids[r]="";a.data.info?t.allPrise=a.data.info.total.check_goods_price:(t.listData=[],t.listData.length=0,t.Listids.length=0);case 11:case"end":return e.stop()}}),e)})))()},allCheck:function(){var t=this;return c(n.default.mark((function e(){var a,i,r,o;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.Listids=[],!t.allcheck){e.next=10;break}return t.allcheck=!1,e.next=5,(0,s.cartCheckAllApi)({ischecked:0});case 5:a=e.sent,t.allPrise=a.data.data.total.goods_price,console.log(a.data),e.next=16;break;case 10:for(t.allcheck=!0,i=0;i<t.listData.length;i++)r=t.listData[i],t.Listids.push(r.goods_id);return e.next=14,(0,s.cartCheckAllApi)({ischecked:1});case 14:o=e.sent,t.allPrise=o.data.data.total.goods_price;case 16:case"end":return e.stop()}}),e)})))()},change:function(t){},goodsDetail:function(e){t.navigateTo({url:"/apiShop/goods/main?id="+e})},changeColor:function(t,e){var a=this;return c(n.default.mark((function i(){var r,o;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.info(t),console.info(e),!a.Listids[t]){n.next=10;break}return a.$set(a.Listids,t,!1),n.next=6,(0,s.cartCheckApi)({id:e,ischecked:0});case 6:r=n.sent,a.allPrise=r.data.data.total.goods_price,n.next=15;break;case 10:return a.$set(a.Listids,t,e),n.next=13,(0,s.cartCheckApi)({id:e,ischecked:1});case 13:o=n.sent,a.allPrise=o.data.data.total.goods_price;case 15:console.log("---------"),console.log(a.allPrise),console.log("===========");case 18:case"end":return n.stop()}}),i)})))()}},computed:{isCheckedNumber:function(){for(var t=0,e=0;e<this.Listids.length;e++)this.Listids[e]&&t++;return t==this.listData.length&&0!=t?this.allcheck=!0:this.allcheck=!1,t}}};e.default=u}).call(this,a("543d")["default"])},"54d5":function(t,e,a){"use strict";(function(t){a("a2bf");n(a("66fd"));var e=n(a("befb"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"710d":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}));var s=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"76dd":function(t,e,a){},9951:function(t,e,a){"use strict";var n=a("76dd"),s=a.n(n);s.a},befb:function(t,e,a){"use strict";a.r(e);var n=a("710d"),s=a("0313");for(var i in s)"default"!==i&&function(t){a.d(e,t,(function(){return s[t]}))}(i);a("9951");var r,o=a("f0c5"),c=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"349f4d9d",null,!1,n["a"],r);e["default"]=c.exports}},[["54d5","common/runtime","common/vendor"]]]);